<!DOCTYPE html>

<head>
  <title>PHYSCI 70: Intro to Digital Fabrication </title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <link href="../styling.css" rel="stylesheet">
  <link href="../hover_pictures.css" rel="stylesheet">
  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
</head>
<body>

<!-- Heading -->
<div class="header_main">
	<header>Week 6: Input Devices
	</header>
</div>

<!-- Nav -->
<div>
	<nav><a href='../index.html'>Home</a></nav>
</div>

<div class="row">
  <div class="col-sm-1">
  </div>
  <div class="col-sm-6">
            <h3 class="center"> I broke my Metro: </h3>
            <p> This week I broke my metro. Not sure what I did exactly (I have a few ideas), but it seems to over heat within a few minute of being plugged in and the port is not registering. But I have an UNO... that I don't have a plug for where I am currently. So the work I did the week consisted mainly of the huzzah as the main microcontroller and after a few workarounds everything worked out.  
            </p>
        </div>
    <div class="col-sm-4">
      <figure> <img src="./broken_metro.jpg" class="image" alt="Broken Metro Code">
        <figcaption class="center"> </figcaption>
      </figure>
    </div>
    <div class="col-sm-1">
  </div>
</div>

</br>

<div class="row">
  <div class="col-sm-1">
  </div>
    <div class="col-sm-4">
      <figure> <img src="./led_circuit.jpg" class="image" alt="LED Circuit">
        <figcaption class="center"> </figcaption>
      </figure>
    </div>
    <div class="col-sm-6">
            <h3 class="center"> Input and Output Devices: </h3>
            <h4 class =" center"> Laser: </h4>
            <p> Besides the little hiccup with the metro, this week was pretty productive for me. I started to try to get an idea of how my final project will work out. I started by placing aligator clips on my laser so I can control when my laser turns on and off. This also allows me to connect it to an external battery pack. It took me a little while to figure out how exactly to control the laser using the microcontroller using a transistor, but with a suggestion from Nathan I found an example of a motor being run with a transistor and I was ale to receate the circuit with a laser instead of a motor. Although not terribly important for what I did the rest of this week, the flashing of the laser is going to be vital for my final project and having the correct timings. 
            </p>
            <P> After getting the laser to hook up I went back to the "Mulitasking with Arduino" tutorial and was able to pull their class for blinking the LED without the use of the delay function. I changed very little since it was essentially all I needed. What I have within the Arduino program can be seen below.
            </P>
        </div>
    <div class="col-sm-1">
  </div>
</div>

</br>

<div class="row">
  <div class="col-sm-1">
    </div>
    <div class="col-sm-10">
      <div style="width:100%;height:250px;line-height:3em;overflow:auto;padding:5px;">
              <figure>
                <figcaption class="center"> Laser Class:</figcaption>
                <pre>
                  <code>
                    class Laser
                      {
                        int laserPin;
                        long OnTime;
                        long OffTime;
                       
                        int laserState;
                        unsigned long previousMillis;

                        public:
                        Laser(int pin, long on, long off)
                        {
                        laserPin = pin;
                        pinMode(laserPin, OUTPUT);     
                          
                        OnTime = on;
                        OffTime = off;
                        
                        laserState = LOW; 
                        previousMillis = 0;
                        }
                       
                        void Update()
                        {
                          unsigned long currentMillis = millis();
                           
                          if((laserState == HIGH) && (currentMillis - previousMillis >= OnTime))
                          {
                            laserState = LOW;
                            previousMillis = currentMillis;
                            digitalWrite(laserPin, laserState);
                          }
                          else if ((laserState == LOW) && (currentMillis - previousMillis >= OffTime))
                          {
                            laserState = HIGH;
                            previousMillis = currentMillis;
                            digitalWrite(laserPin, laserState);
                          }
                        }
                      };
                  </code>
                </pre>
              </figure>
            </div>
          </div>
    <div class="col-sm-1">
  </div>
</div>

</br>

<div class="row">
  <div class="col-sm-1">
  </div>
    <div class="col-sm-4">
      <figure> <img src="./full_circuit.jpg" class="image" alt="Full Circuit">
        <figcaption class="center"> </figcaption>
      </figure>
    </div>
    <div class="col-sm-6">
            <h4 class =" center"> Light Sensor + Peizo: </h4>
            <p> My plan was to use the laser, make the light hit a light sensor, which would then tell a buzzer (since I don't have a MIDI jack to make sounds with my conputer) to play a sound. I realized fast that making a peizo play using the Huzzah was a little more elaborate than using the metro. The Huzzah does not support arduino's 'Tone' function. There is a workaround for this though the use of different commands (which you can see below). Essentially, from my understanding, the peizo is treated similar to a LED which we send a Pulse Width Modulation signal though. I ended up getting the buzzer to play so I then started to work on interfacing the light sensor with it.
            </p>
            <p> Within the class I made for the buzzer I essentially used analogRead to map the light level the sensor was experiencing to a variable "value." This then allowed me to say, "if value > (about the light level in the room at the time + some), then make noise. Else, don't make noise." This works fine since the light that is redirected from the laser to the sensor usually has a significant change. You can think of this as the ambient light temperature being the ground state or 0-point, and every time enough diffuse light from the laser hit the sensor it 'jumps' away from this ground state and if there is enough light it 'jumps' through the ceiling. The 'breaking' of this ceiling is what tells the buzzer to play. One downside of this that I see is that I have to adjust the sensor to different light levels. I am thinking of a way to change this so it knows automatically and calibrate isn't very necessary.
            </p>
            <p>I then combing the wirings and then the code into the same program and uploaded it onto the Huzzah. The circiutry can be seen on the left.
            </p>
        </div>
    <div class="col-sm-1">
  </div>
</div>

</br>

<div class="row">
  <div class="col-sm-1">
    </div>
    <div class="col-sm-10">
      <div style="width:100%;height:250px;line-height:3em;overflow:auto;padding:5px;">
              <figure>
                <figcaption class="center"> Sensor + Buzzer Class:</figcaption>
                <pre>
                  <code>
                    class Sound 
                      {
                        int buzzerPin;
                        int value;

                        int freqOff=0;
                        int freq = 50; 
                        int channel = 0; 
                        int resolution = 8;
                        int lightLevel = 1500;      // ###INSERT LIGHT LEVEL HERE + SOME###
                        
                        public:
                        Sound(int buzzerPin, int hertz, int PWMchannel, int PWMresolution)
                        {
                          channel = PWMchannel;
                          freq = hertz;
                          resolution = PWMresolution;

                          ledcSetup(channel, freq, resolution);
                          ledcAttachPin(buzzerPin, channel);

                          ledcWriteTone(channel, freqOff);
                        }

                        void Update()
                        {
                          value = analogRead(A3);
                          Serial.println(value);
                          if (value > lightLevel)
                          {
                          ledcWriteTone(channel, freq);
                          delay(100);
                          }
                          else 
                          {
                          ledcWriteTone(channel, freqOff);
                          }
                        }
                      };
                  </code>
                </pre>
              </figure>
            </div>
          </div>
    <div class="col-sm-1">
  </div>
</div>

</br>

<div class="row">
  <div class="col-sm-1">
  </div>
    <div class="col-sm-6">
            <h4 class =" center"> Final Product: </h4>
            <p> Although my class for the laser does not do much, the final code can be seen below. To the right you can see a video of the final product and how the sensor behaves when it is covered (fully and partly) and how the sensor has a strong response to the laser light.
            </p>
  </div>
  <div class="col-sm-4">
    <figure style="margin-bottom: 15px">
      <iframe width="100%" src="https://www.youtube.com/embed/_D7FJ12aApM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="img-responsive margin" alt="Laser Controlled Piezo YouTube"></iframe>
      <figcaption class="center"> A brief youtube video of the components of a laser harp.</figcaption>
    </figure>
  </div>
  <div class="col-sm-1">
  </div>
</div>

</br>

<div class="row">
  <div class="col-sm-1">
    </div>
    <div class="col-sm-10">
      <div style="width:100%;height:250px;line-height:3em;overflow:auto;padding:5px;">
              <figure>
                <figcaption class="center"> User Input Code:</figcaption>
                <pre>
                  <code>
                      Laser laser(A0, 1000, 0);
                      Sound sound(16, 1000, 0, 8);

                      void setup()
                      {
                        Serial.begin(9600);
                      }

                      void loop()
                      {
                        laser.Update();
                        sound.Update();
                      }
                  </code>
                </pre>
              </figure>
            </div>
          </div>
    <div class="col-sm-1">
  </div>
</div>

</br>

<div class="row">
  <div class="col-sm-1">
  </div>
    <div class="col-sm-6">
            <h3 class="center"> Final Project 3D models: </h3>
            <p> I also got a better idea of what I need for my 3D models. The laser needs to be held with a clothespin to hit the button and complete the circuit, so I figured that I need something to hold the clothespin and laser and then I need something to mount the stepper motor on so that when it is spinning back and forth to project the laser it doesn't shift. Both these models can be seen below in what how I expect the final configuration be set up. The clothespin was uploaded in and I had to scale it myself and 'press-it' so it looks weird but the gist is there.
            </p>
    </div>
    <div class="col-sm-4">
      <figure> <img src="./motor_holder.jpg" class="image" alt="Motor Holder">
        <figcaption class="center"> </figcaption>
      </figure>
    </div>
  <div class="col-sm-1">
  </div>
</div>

</br>

<div class="row">
  <div class="col-sm-1">
    </div>
    <div class="col-sm-10">
      <div style="width:100%;height:250px;line-height:3em;overflow:auto;padding:5px;">
              <figure>
                <iframe src="https://myhub.autodesk360.com/ue2f9e3e8/shares/public/SH56a43QTfd62c1cd9684efd7518f9cd3a0d?mode=embed" width="100%" height="768px" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"  frameborder="0"></iframe>
              </figure>
            </div>
          </div>
    <div class="col-sm-1">
  </div>
</div>

</br>

<div class="row">
  <div class="col-sm-1">
  </div>
    <div class="col-sm-6">
            <h3 class="center"> Miscellaneous: </h3>
            <h4 class="center"> Stepper Motor </h4>
            <p> Besides breaking my metro, playing around with lasers and the piezo, and creating some 3D models, I also tinkered with the stepper. I was hoping to add that into my system for this week but I had some problems. The first and biggest problem was completely my own fault since I missed the fact we had a stepper driver in the kit. I realized this after some time trying to get the stepper to turn with no such luck. After I realized we had the driver,  
            </p>
            <h4 class="center"> Huzzah and ESP-32 CAM</h4>
            <p> Although I didn't really know how to show it effectively, I did get the huzzah to control a led through my browser. I also, got the ESP 32 CAM to work after some tinkering. A photo can be seen of that. 
            </p>

    </div>
    <div class="col-sm-4">
      <div id="myCarousel_2" class="carousel slide" data-ride="carousel">
          <!-- Indicators -->
          <ol class="carousel-indicators">
            <li data-target="#myCarousel_2" data-slide-to="0" class="active"></li>
            <li data-target="#myCarousel_2" data-slide-to="1"></li>
          </ol>

          <!-- Wrapper for slides -->
          <div class="carousel-inner">
            <div class="item active">
              <img src="./stepper.jpg" alt="Stepper Motor and Driverr">
              <div class="carousel-caption">
                <h2>Stepper Motor</h2>
                <p></p>
              </div>
            </div>

            <div class="item">
              <img src="./esp32-com-me.jpg" alt="ESP 32 CAM">
              <div class="carousel-caption">
                <h2>ESP 32 Camera</h2>
                <p></p>
              </div>
            </div>
          <!-- Left and right controls -->
          <a class="left carousel-control" href="#myCarousel_2" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="right carousel-control" href="#myCarousel_2" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
      </div>
    </div>
  <div class="col-sm-1">
  </div>
</div>

</br>

</body>